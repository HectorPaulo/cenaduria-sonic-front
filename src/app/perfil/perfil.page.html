<app-header titulo="Mi Perfil"></app-header>

<ion-content [fullscreen]="true" class="bg-white">
  <ion-refresher
    slot="fixed"
    (ionRefresh)="doRefresh($event)"
    pullFactor="0.8"
    pullMin="60"
    pullMax="120"
  >
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <app-fabbtn></app-fabbtn>
  <div class="max-w-lg mx-auto p-4 mt-16">
    <!-- Información del Usuario -->
    <div class="relative mb-6">
      <!-- Foto de perfil -->
      <div class="flex justify-center mb-6">
        <div class="relative">
          <input
            type="file"
            #fileInput
            accept="image/*"
            hidden
            (change)="onFileSelected($event)"
          />
          <img
            [src]="usuario.avatar"
            [alt]="usuario.nombre"
            class="w-32 h-32 rounded-full border-4 border-purple-200 shadow-lg object-cover"
          />
        </div>
      </div>

      <!-- Datos básicos -->
      <div class="text-center mb-6">
        <h2 class="text-3xl font-bold text-gray-800 mb-2">
          {{ usuario.nombre }}
        </h2>
        <p class="text-gray-600 text-lg mb-1">{{ usuario.email }}</p>
        <p class="text-sm text-gray-500">
          <ion-icon
            name="calendar-outline"
            class="align-middle mr-1"
          ></ion-icon>
          Miembro desde {{ usuario.fechaRegistro }}
        </p>
      </div>
    </div>

    <!-- Opciones del Perfil -->
    <div class="space-y-4">
      <!-- Seguridad -->
      <ion-card mode="ios" class="shadow-md">
        <ion-card-header>
          <ion-card-title class="text-lg font-semibold text-gray-800">
            <ion-icon
              name="shield-checkmark-outline"
              class="mr-2 text-purple-600"
            ></ion-icon>
            Seguridad
          </ion-card-title>
        </ion-card-header>
        <ion-card-content class="space-y-3">
          <div
            class="flex justify-between items-center py-3 cursor-pointer hover:bg-gray-50 rounded-lg px-2 transition-colors"
            (click)="cambiarPassword()"
          >
            <div class="flex items-center">
              <div class="bg-purple-100 p-2 rounded-lg mr-3">
                <ion-icon
                  name="key-outline"
                  class="text-purple-600 text-xl"
                ></ion-icon>
              </div>
              <div>
                <p class="font-medium text-gray-800">Cambiar contraseña</p>
                <p class="text-sm text-gray-600">
                  Actualizar tus credenciales de acceso
                </p>
              </div>
            </div>
            <ion-icon
              name="chevron-forward-outline"
              class="text-gray-400"
            ></ion-icon>
          </div>

          <div
            class="flex justify-between items-center py-3 cursor-pointer hover:bg-gray-50 rounded-lg px-2 transition-colors"
            (click)="cambiarFoto()"
          >
            <div class="flex items-center">
              <div class="bg-blue-100 p-2 rounded-lg mr-3">
                <ion-icon
                  name="image-outline"
                  class="text-blue-600 text-xl"
                ></ion-icon>
              </div>
              <div>
                <p class="font-medium text-gray-800">Cambiar foto de perfil</p>
                <p class="text-sm text-gray-600">
                  Actualizar tu imagen de perfil
                </p>
              </div>
            </div>
            <ion-icon
              name="chevron-forward-outline"
              class="text-gray-400"
            ></ion-icon>
          </div>
        </ion-card-content>
      </ion-card>

      <!-- Información -->
      <ion-card mode="ios" class="shadow-md">
        <ion-card-header>
          <ion-card-title class="text-lg font-semibold text-gray-800">
            <ion-icon
              name="information-circle-outline"
              class="mr-2 text-gray-600"
            ></ion-icon>
            Información
          </ion-card-title>
        </ion-card-header>
        <ion-card-content class="space-y-3">
          <div
            class="flex justify-between items-center py-3 cursor-pointer hover:bg-gray-50 rounded-lg px-2 transition-colors"
            (click)="acercaDe()"
          >
            <div class="flex items-center">
              <div class="bg-gray-100 p-2 rounded-lg mr-3">
                <ion-icon
                  name="help-circle-outline"
                  class="text-gray-600 text-xl"
                ></ion-icon>
              </div>
              <div>
                <p class="font-medium text-gray-800">Acerca de</p>
                <p class="text-sm text-gray-600">Versión y términos de uso</p>
              </div>
            </div>
            <ion-icon
              name="chevron-forward-outline"
              class="text-gray-400"
            ></ion-icon>
          </div>
        </ion-card-content>
      </ion-card>

      <!-- Acciones -->
      <div class="space-y-3 mt-6">
        <ion-button
          fill="clear"
          color="danger"
          expand="block"
          class="font-semibold"
          (click)="cerrarSesion()"
        >
          <ion-icon name="log-out-outline" slot="start"></ion-icon>
          Cerrar Sesión
        </ion-button>
      </div>
    </div>
  </div>
</ion-content>
